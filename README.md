# ably

[![Build Status](http://img.shields.io/travis/vgno/ably/master.svg?style=flat-square)](https://travis-ci.org/vgno/ably)[![Test Coverage](http://img.shields.io/codeclimate/coverage/github/vgno/ably.svg?style=flat-square)](https://codeclimate.com/github/vgno/ably)[![Code Climate](http://img.shields.io/codeclimate/github/vgno/ably.svg?style=flat-square)](https://codeclimate.com/github/vgno/ably)![Status](https://img.shields.io/badge/maturity-unstable-red.svg?style=flat-square)

Provides a framework to perform A/B tests in the browser. This is still work in progress.

## Usage example

```js
// Add a test
ably.addTest(
    {
        name: 'button-color',
        variants: ['red', 'green'],
        randomizer: ably.mathRandomRandomizer,
        scope: new CookieScope()
    }
);

// Subscribe to variants
ably
    .when('button-color', 'red', function () {
        $('buy-button').css('background-color', 'red');
    })
    .when('button-color', 'green', function () {
        $('buy-button').css('background-color', 'green');
    });
```

## APIs

Ably exposes three APIs: JS, HTML and CSS.

![Ably interface](docs/ably-interface.png)

### JS API

The JS API allows you to subscribe to different variants.

```js
ably
    .when('button-color', 'red', function () {
        $('buy-button').css('background-color', 'red');
    })
    .when('button-color', 'green', function () {
        $('buy-button').css('background-color', 'green');
    });
```

### HTML & CSS APIs

The HTML & CSS APIs make it possible to write an A/B test almost entirely in HTML or CSS. They also help avoid the flickering effect when showing/hiding/manipulating DOM elements via Javascript.

This is achieved by making the browser able to style elements early, before the DOM is even fully loaded.

#### HTML API

HTML:

```html
<!-- Ably automatically appends the selected variant as a class to the body element -->
<body class="ably-button-text-buy">

  <!-- You add class names to variants you want to show/hide -->
  <button class="ably-button-text-buy">
    Buy Now!
  </button>

  <button class="ably-button-text-subscribe">
    Subscribe!
  </button>

</body>
```

CSS:

```css
/*
 * CSS autogenerated by Ably
 */
body[class*="ably-button-text"] *[class*="ably-button-text"] {
    display: none;
}

body.ably-button-text-buy *[class*="ably-button-text-buy"] {
    display: initial;
}

body.ably-button-text-subscribe *[class*="ably-button-text-subscribe"] {
    display: initial;
}
```

#### CSS API

HTML:

```html
<!-- Ably automatically appends the selected variant as a class to the body element -->
<body class="ably-button-color-red">

  <button id="buy-now-button">
    Buy Now!
  </button>

</body>
```

CSS:

```css
/*
 * You specify different CSS rules for variants
 */
body.ably-button-color-red #buy-now-button
    background-color: #ff0000;
}

body.ably-button-color-green #buy-now-button
    background-color: #00ff00;
}
```

## Architecture

Read more about the architecture in [Architecture](docs/architecture.md).
